{"version":3,"sources":["js/notify.js"],"names":["View","Data","template","Marionette","extend","className","triggers","click","onShowPopup","options","title","content","module_user","Actions","rootView","getRegion","show","popup","Popup","initialize","map","onBeforeAttach","this","collection","app","taskRouteCollection","router","e","trigger","currentTarget","dataset","id","url","zoneId","navigate","console","log","remove","L","warn","triggerMethod","onInitMap","mapOptions","_this","scrollWheelZoom","tileLayer","el","attribution","minZoom","maxZoom","continuousWorld","tms","noWrap","addTo","setView","bounds","latLngBounds","setMaxBounds","panInsideBounds","animate","_","forEach","models","model","coords","get","classPostfix","sample","html","divIcon","hue","polyline","marker","color","addLayer","on","latlng","lat","lng","window","module_notify","Entry"],"mappings":"CAAC,WAED,GAAAA,GAAIA,MACJC,EAAIA,KAKHC,GAAAA,MAAUC,WAAAH,KADyBI,QAEnCC,SAAAA,cACAC,UAAU,YACTA,UADSC,MAHyB,cAOlCC,YAAIC,WACHC,GAAAA,IACAC,MAAAA,aAFaA,QAAd,GAAAC,aAAAZ,KAAAa,SAKAC,EAASC,GAAAA,OAAUN,EACnBK,UAAAC,UAAA,SAAAC,KAAAC,MAMDZ,EAAAA,WAAWF,WAAAH,KAAAI,QACXE,SAAAA,aACCD,UAAU,4BADDC,UAGVE,MAAAA,cAEEE,YAAO,WACPC,GAAAA,IAFaD,MAAd,WAIAC,QAAIM,GAAQjB,GAAIkB,KAEhBD,EAAA,GAAAC,OAAAT,EAbgBK,UAAlBC,UAAA,SAAAC,KAAAC,MAoBCZ,EAAAA,IAAAA,WAAWL,KAHsBI,QAIjCe,SAAAA,SACCC,IAAA,KACAf,UANgC,YAOjCgB,WAAAA,SAAgBZ,GACfa,KAAAC,WAAYC,IAASC,qBAEpBJ,eAAU,WACVG,KAAAA,IAAIE,GAAJ,QAAA,2BAAyB,SAAAC,GACxBC,GAAAA,GAASD,EAAAE,cAAAC,QAAAC,GADVC,EAAA,SAAAC,EAAA,QAGAT,KANDE,OAAAQ,SAAAF,GARgCJ,SAAA,OAmB/BO,SAAAA,WACAA,QAAIC,IAAKhB,KAALG,YACMc,mBAATC,KACAH,QAAAI,KAAAjB,KAAAF,KACIoB,MAALlB,KAAKkB,KACLlB,KAAAF,IAAAiB,SAEFI,KAAAA,cAAW,cACVA,UAAIC,WAAa,GAAAC,GAAArB,KAChBsB,GADgBA,iBAAjB,EAIAN,MAAEO,IAAAA,EAAUzB,IAAAE,KAAAwB,GAAAJ,GACXK,EAAAA,UAAAA,uEACAC,YAFkF,8DAGlFC,QAAAA,EACAC,QAAAA,EACAC,iBALkF,EAMlFC,KAAAA,EANkFA,QAAnF,IAQAC,MAAA/B,KAASgC,KACThC,KAAIiC,IAAAA,SAAWC,GAAAA,KAAAA,EACf,IAAAD,GAASE,EAAAA,gBAAT,KAAA,MAAA,IAAA,MACAnC,MAAAF,IAAAqC,aAAoBF,GACnBjC,KAAAF,IAAKA,GAAIsC,OAAAA,WACTf,EAFDvB,IAAAsC,gBAAAH,GAAAI,SAAA,MAIAC,EAAEC,QAAQvC,KAAKC,WAAWuC,OAAQ,SAAAC,GAGjC5B,GAAAA,GAAY6B,KAAAA,MAAZD,EAAAE,IAAA,eAECnC,IADDK,QAAI6B,IAAJA,GACClC,EAAUiC,CACVjC,QAAIb,EAAUf,UACd,IACAgE,IADIA,EAAAA,SAAiBC,EAAAA,oBAAQC,QAAiBtC,SAC/BuC,EAAAA,QAAQ,iBAAA,iBAAA,mBAIvBC,GAHYhC,EAAA+B,SADWhE,UAAvB,UAAA6D,IAIIK,EAAAA,OACFC,GAAAA,MACAC,EAAOnC,EAFMkC,OAAfR,GAICS,MAAA,OAAAH,EAAA,aAhBH3B,GAAAvB,IAAAsD,SAAAH,MAsBCjD,KAFDF,IAAAuD,GAAA,QAAA,SAAAhD,GAGAQ,QAAAC,KAAAT,EAAAiD,OAAAC,IAAAlD,EAAAiD,OAAAE,WAMFC,OAAOC,eAAgBhF,KAAvBA,EApHCC,KAADA,EAuHCgF,MAAOjF,EAAKiF","file":"notify.js","sourcesContent":["(function(){\r\n\t\r\nvar View = View || {};\r\nvar Data = Data || {};\r\nvar Behaviors = Behaviors || {};\r\n\r\n\r\nView.Entry = Marionette.View.extend({\r\n\ttemplate: '#notify-btn',\r\n\tclassName: 'fixed-btn',\r\n\ttriggers: {\r\n\t\t'click' : 'show:popup'\r\n\t},\r\n\tonShowPopup: function() {\r\n\t\tvar options = {\r\n\t\t\ttitle: 'My actions',\r\n\t\t\tcontent: new module_user.View.Actions(),\r\n\t\t}\r\n\t\tvar popup = new Popup(options);\r\n\t\trootView.getRegion('popup').show(popup)\r\n\t},\r\n});\r\n\r\n\r\nView.EntryRoute = Marionette.View.extend({\r\n\ttemplate: '#route-btn',\r\n\tclassName: 'fixed-btn fixed-btn-route',\r\n\ttriggers: {\r\n\t\t'click' : 'show:popup'\r\n\t},\r\n\tonShowPopup: function() {\r\n\t\tvar options = {\r\n\t\t\ttitle: 'My route',\r\n\t\t\tcontent: new View.Map(),\r\n\t\t}\r\n\t\tvar popup = new Popup(options);\r\n\t\trootView.getRegion('popup').show(popup)\r\n\t},\r\n});\r\n\r\n\r\nView.Map = Marionette.View.extend({\r\n\ttemplate: '#t-map',\r\n\tmap: null,\r\n\tclassName: 'popup-map',\r\n\tinitialize: function(options) {\r\n\t\tthis.collection = app.taskRouteCollection;\r\n\t},\r\n\tonBeforeAttach: function() {\r\n\t\tthis.$el.on('click', '[data-action=\"navigate\"]', (e) => {\r\n\t\t\tvar zoneId = e.currentTarget.dataset.id;\r\n\t\t\tvar url = 'zones/'+zoneId+'/units';\r\n\t\t\tapp.router.navigate(url, {\r\n\t\t\t\ttrigger: true\r\n\t\t\t})\r\n\t\t})\r\n\t},\r\n\tonAttach: function() {\r\n\t\tconsole.log(this.collection);\r\n\t\tif (typeof L !== 'undefined') {\r\n\t\t\tconsole.warn(this.map);\r\n\t\t\tif (this.map != null) {\r\n\t\t\t\tthis.map.remove();\r\n\t\t\t}\r\n\t\t\tthis.triggerMethod('init:map')\r\n\t\t}\r\n\t},\r\n\tonInitMap: function() {\r\n\t\tvar mapOptions = {\r\n\t\t\tscrollWheelZoom: false,\r\n\t\t}\r\n\t\tthis.map = L.map(this.el, mapOptions);\r\n\t\tL.tileLayer('http://85.188.8.254/back/IB_floorplan_72.53mx72.53m/{z}/{x}/{y}.png', {\r\n\t\t\tattribution: '&copy; <a target=\"_blank\" href=\"http://tieto.com\">Tieto</a>',\r\n\t\t\tminZoom: 1,\r\n\t\t\tmaxZoom: 6,\r\n\t\t\tcontinuousWorld: false,\r\n\t\t\ttms: true,\r\n\t\t\tnoWrap: true\r\n\t\t}).addTo(this.map);\r\n\t\tthis.map.setView([0,-100], 1);\r\n\t\tvar bounds = L.latLngBounds([[-180, -180], [180, 180]]);\r\n\t\tthis.map.setMaxBounds(bounds);\r\n\t\tthis.map.on('drag', () => {\r\n\t\t\tthis.map.panInsideBounds(bounds, { animate: true });\r\n\t\t});\r\n\r\n\t\t_.forEach(this.collection.models, model => {\r\n\r\n\t\t\tvar coords = JSON.parse(model.get('coordinates'));\r\n\t\t\tconsole.log(coords);\r\n\t\t\tif (coords) {\r\n\t\t\t\tdataset = model.attributes;\r\n\t\t\t\tvar popup = _.template($('#t-polygon-popup').html())(dataset);\r\n\t\t\t\tvar classPostfix = _.sample(['marker-success','marker-warning','marker-danger'])\r\n\t\t\t\tvar myIcon = L.divIcon({\r\n\t\t\t\t\tclassName: 'marker '+classPostfix\r\n\t\t\t\t});\r\n\t\t\t\tvar hue = _.random(10,100);\r\n\t\t\t\tvar polyline = L\r\n\t\t\t\t\t.marker(coords, {\r\n\t\t\t\t\t\tcolor: 'hsl('+hue+',70%,50%)'\r\n\t\t\t\t\t})\r\n\t\t\t\t\t// .bindPopup(popup)\r\n\t\t\t\tthis.map.addLayer(polyline);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.map.on('click', function(e) {\r\n\t\t\tconsole.log([e.latlng.lat,e.latlng.lng]);    \r\n\t\t});\r\n\t\t// this.map.addLayer(popup);\r\n\t},\r\n})\r\n\r\n\r\n\r\nwindow.module_notify = {\r\n\tView: View,\r\n\tData: Data,\r\n\tEntry: View.Entry,\r\n\r\n}\r\n\r\n}());"]}