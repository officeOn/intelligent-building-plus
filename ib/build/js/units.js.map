{"version":3,"sources":["js/units.js"],"names":["View","Data","Backbone","extend","defaults","id","cid","name","health","cleaningItems","model","initialize","options","this","url","Marionette","template","regions","RegionSetter","onRender","onChildviewShowMarker","show","List","getRegion","Map","map","className","onAttach","console","warn","remove","triggerMethod","onInitMap","_this","mapOptions","scrollWheelZoom","L","el","attribution","minZoom","maxZoom","continuousWorld","tms","noWrap","addTo","dataset","attributes","coords","get","_","isArray","popup","$","html","classPostfix","sample","myIcon","divIcon","bounds","latLngBounds","setMaxBounds","on","panInsideBounds","animate","marker","icon","bindPopup","addLayer","latlng","lat","e","log","lng","ListItemEmpty","ListItem","tagName","ui","btnHolder","btns","mapBtn","toolsBtn","triggers","click header.main","click @ui.mapBtn","onToggleButtons","$el","toggleClass","getUI","slideToggle","hasClass","empty","onHideRegions","removeClass","onShowInfo","addClass","Info","refillable","RefillableWrapper","cleanable","CleanableWrapper","Collection","CleanableItem","title","content","onShowPopup","rootView","CleanableTools","unitId","Popup","CleanableToolEmpty","cleaningToolName","childView","CleanableTool","emptyView","collection","collectionEvents","CollectionView","CleanableItemEmpty","_this2","Cleanable","fetch","Refillable","RefillableItem","_this3","RefillableItemEmpty","onSync","render","window","module_units","view","Entry","models"],"mappings":"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","file":"units.js","sourcesContent":["(function(){\r\n\t\r\nvar View = View || {};\r\nvar Data = Data || {};\r\nvar Behaviors = Behaviors || {};\r\n\r\nData.ListItem = Backbone.Model.extend({\r\n\tdefaults: function() {\r\n\t\treturn {\r\n\t\t\tid: this.cid,\r\n\t\t\tname: 'No-title',\r\n\t\t\thealth: 20,\r\n\t\t\tcleaningItems: ['Mop']\r\n\t\t}\r\n\t}\r\n});\r\nData.List = Backbone.Collection.extend({\r\n\tmodel: Data.ListItem,\r\n\tinitialize: function(options) {\r\n\t\tthis.url = '/back/index.php/zones/'+options.id+'/units'\r\n\t}\r\n});\r\n\r\nView.Entry = Marionette.View.extend({\r\n\ttemplate: '#units-entry',\r\n\tregions: new RegionSetter('list', 'map'),\r\n\tinitialize: function(options) {\r\n\r\n\t},\r\n\tonRender: function() {\r\n\t\tthis.getRegion('list').show(new View.List(this.options));\r\n\t},\r\n\tonChildviewShowMarker: function(model) {\r\n\t\tthis.getRegion('map').show(new View.Map({\r\n\t\t\tmodel: model\r\n\t\t}))\r\n\t}\r\n});\r\n\r\nView.Map = Marionette.View.extend({\r\n\ttemplate: '#t-map',\r\n\tmap: null,\r\n\tclassName: 'mini-map',\r\n\tinitialize: function(options) {\r\n\t\tthis.model = options.model;\r\n\t},\r\n\tonAttach: function() {\r\n\t\tconsole.log(this.model);\r\n\t\tif (typeof L !== 'undefined') {\r\n\t\t\tconsole.warn(this.map);\r\n\t\t\tif (this.map != null) {\r\n\t\t\t\tthis.map.remove();\r\n\t\t\t}\r\n\t\t\tthis.triggerMethod('init:map')\r\n\t\t}\r\n\t},\r\n\tonInitMap: function() {\r\n\t\tvar mapOptions = {\r\n\t\t\tscrollWheelZoom: false,\r\n\t\t}\r\n\t\tthis.map = L.map(this.el, mapOptions);\r\n\t\tL.tileLayer('http://85.188.8.254/back/IB_floorplan_72.53mx72.53m/{z}/{x}/{y}.png', {\r\n\t\t\tattribution: '&copy; <a target=\"_blank\" href=\"http://tieto.com\">Tieto</a>',\r\n\t\t\tminZoom: 1,\r\n\t\t\tmaxZoom: 6,\r\n\t\t\tcontinuousWorld: false,\r\n\t\t\ttms: true,\r\n\t\t\tnoWrap: true\r\n\t\t}).addTo(this.map);\r\n\r\n\t\t\tdataset = this.model.attributes;\r\n\t\t\tvar coords = this.model.get('coordinates');\r\n\t\t\tif (!_.isArray(coords)) {\r\n\t\t\t\tcoords = [0,0];\r\n\t\t\t}\r\n\t\t\tvar popup = _.template($('#t-list-map-popup').html())(dataset);\r\n\t\t\tvar classPostfix = _.sample(['marker-success','marker-warning','marker-danger'])\r\n\t\t\tvar myIcon = L.divIcon({\r\n\t\t\t\tclassName: 'marker '+classPostfix\r\n\t\t\t});\r\n\t\t\tvar bounds = L.latLngBounds([[-180, -180], [180, 180]]);\r\n\t\t\tthis.map.setMaxBounds(bounds);\r\n\t\t\tthis.map.on('drag', () => {\r\n\t\t\t\tthis.map.panInsideBounds(bounds, { animate: true });\r\n\t\t\t});\r\n\t\t\tvar marker = L\r\n\t\t\t\t.marker(coords, {\r\n\t\t\t\t\ticon: myIcon,\r\n\t\t\t\t})\r\n\t\t\t\t.bindPopup(popup)\r\n\t\r\n\t\tthis.map.addLayer(marker);\r\n\t\tthis.map.setView(coords, 2);\r\n\t\tthis.map.on('click', function(e) {\r\n\t\t\tconsole.log([e.latlng.lat,e.latlng.lng]);    \r\n\t\t});\r\n\t\t// this.map.addLayer(popup);\r\n\t},\r\n})\r\n\r\nView.ListItemEmpty = Marionette.View.extend({\r\n\ttemplate: _.template('<div class=\"alert alert-info\">No data, please try again later</div>'),\r\n});\r\nView.ListItem = Marionette.View.extend({\r\n\ttemplate: '#units-listItem',\r\n\tclassName: 'list-group-item-light',\r\n\ttagName: 'li',\r\n\tregions: new RegionSetter('map','info','refillable','cleanable'),\r\n\tui: {\r\n\t\t'btnHolder' : '.btn-holder',\r\n\t\t'btns': '[data-action=\"trigger\"]',\r\n\t\t'mapBtn' : '[data-id=\"map\"]',\r\n\t\t'toolsBtn' : '[data-id=\"tools\"]',\r\n\t\t'closeBtn' : '[data-action=\"close\"]',\r\n\t},\r\n\ttriggers: {\r\n\t\t// click : 'open:map'\r\n\t\t'click header.main': 'toggle:buttons',\r\n\t\t'click @ui.mapBtn': 'show:map',\r\n\t\t'click @ui.toolsBtn': 'show:info',\r\n\t\t// 'click @ui.closeBtn': 'close',\r\n \t},\r\n \tonToggleButtons: function() {\r\n \t\tthis.$el.toggleClass('opened');\r\n \t\tthis.getUI('btnHolder').slideToggle();\r\n \t\tthis.triggerMethod('hide:regions');\r\n\r\n \t\t// govnocode starts\r\n \t\tif (this.$el.hasClass('opened')) {\r\n\r\n \t\t}\r\n \t},\r\n \tonHideRegions: function() {\r\n \t\tthis.getRegion('map').empty();\r\n \t\t// this.getRegion('cleanable').empty();\r\n \t\t// this.getRegion('refillable').empty();\r\n \t\tthis.getRegion('info').empty();\r\n \t\tthis.getUI('btns').removeClass('btn-fill');\r\n \t},\r\n \tonShowMap: function() {\r\n \t\tthis.triggerMethod('hide:regions');\r\n\r\n \t\tthis.getUI('mapBtn').addClass('btn-fill');\r\n \t\tthis.getRegion('map').show(new View.Map({\r\n \t\t\tmodel: this.model\r\n \t\t}));\r\n \t},\r\n \tonShowInfo: function() {\r\n \t\tthis.triggerMethod('hide:regions');\r\n\r\n \t\tthis.getUI('toolsBtn').addClass('btn-fill');\r\n \t\tthis.getRegion('info').show(new View.Info({\r\n \t\t\tmodel: this.model\r\n \t\t}));\r\n\r\n \t}\r\n});\r\n\r\nView.Info = Marionette.View.extend({\r\n\ttemplate: '#Info',\r\n\tregions: new RegionSetter('cleanable','refillable'),\r\n\tinitialize: function(options) {\r\n\t\tthis.model = options.model;\r\n\t},\r\n\tonRender: function() {\r\n\r\n\t\tvar refillable = new View.RefillableWrapper({\r\n\t\t\tid: this.model.id\r\n\t\t});\r\n\t\tthis.getRegion('refillable').show(refillable);\r\n\r\n\t\tvar cleanable = new View.CleanableWrapper({\r\n\t\t\tid: this.model.id\r\n\t\t});\r\n\t\tthis.getRegion('cleanable').show(cleanable);\r\n\r\n\t}\r\n})\r\n// CLEANable\r\n// CLEANable\r\n// CLEANable\r\n// CLEANable\r\n\r\nData.Cleanable = Backbone.Collection.extend({\r\n\tinitialize: function(options) {\r\n\t\tthis.url = '/back/index.php/units/'+options.id+'/cleanable';\r\n\t}\r\n});\r\n\r\nView.CleanableItem = Marionette.View.extend({\r\n\ttemplate: '#CleanableItem',\r\n\ttriggers: {\r\n\t\t'click' : 'show:popup'\r\n\t},\r\n\tonShowPopup: function() {\r\n\t\tconsole.log(this.model);\r\n\t\tvar options = {\r\n\t\t\ttitle: this.model.get('name'),\r\n\t\t\tcontent: new View.CleanableTools({\r\n\t\t\t\tid: this.model.id,\r\n\t\t\t\tunitId: this.model.get('unitId')\r\n\t\t\t}),\r\n\t\t}\r\n\t\tvar popup = new Popup(options);\r\n\t\trootView.getRegion('popup').show(popup)\r\n\t},\r\n});\r\n\r\nView.CleanableTool = Marionette.View.extend({\r\n\ttemplate: _.template('<header><%-cleaningToolName%></header>'),\r\n\tclassName: 'list-group-item-light',\r\n\tinitialize: function() {\r\n\t\tconsole.log(this.model);\r\n\t}\r\n});\r\nView.CleanableToolEmpty = Marionette.View.extend({\r\n\ttemplate: '#loading',\r\n\tinitialize: function() {\r\n\t\tconsole.log(this.model);\r\n\t}\r\n});\r\nData.CleanableTool = Backbone.Model.extend({\r\n\tdefaults: function() {\r\n\t\treturn {\r\n\t\t\tcleaningToolName: 'Sponge'\r\n\t\t}\r\n\t}\r\n})\r\nData.CleanableTools = Backbone.Collection.extend({\r\n\tmodel: Data.CleanableTool,\r\n\tinitialize: function(options) {\r\n\t\tthis.url = '/back/index.php/units/'+options.unitId+'/cleanable/'+options.id\r\n\t}\r\n});\r\nView.CleanableTools = Marionette.CollectionView.extend({\r\n\tchildView: View.CleanableTool,\r\n\temptyView: View.CleanableToolEmpty,\r\n\tinitialize: function(options) {\r\n\t\tthis.collection = new Data.CleanableTools(options);\r\n\t\tthis.collection.fetch();\r\n\t},\r\n\tcollectionEvents: {\r\n\t\t'sync' : 'render'\r\n\t}\r\n});\r\n\r\nView.CleanableItemEmpty = Marionette.View.extend({\r\n\ttemplate: _.template('EMPTY'),\r\n});\r\nView.CleanableWrapper = Marionette.View.extend({\r\n\ttemplate: '#CleanableWrapper',\r\n\tregions: new RegionSetter('list'),\r\n\tinitialize: function(options) {\r\n\r\n\t},\r\n\tonRender: function() {\r\n\t\tcollection = new Data.Cleanable(this.options);\r\n\t\tcollection.fetch();\r\n\t\tcollection.on('sync', collection => {\r\n\t\t\tthis.getRegion('list').show(new View.Cleanable({\r\n\t\t\t\tcollection: collection\r\n\t\t\t}))\r\n\t\t})\r\n\t}\r\n});\r\nView.Cleanable = Marionette.CollectionView.extend({\r\n\tchildView: View.CleanableItem,\r\n\temptyView: View.CleanableItemEmpty,\r\n\tinitialize: function(options) {\r\n\t},\r\n});\r\n\r\n\r\n\r\n// REFILLable\r\n// REFILLable\r\n// REFILLable\r\n// REFILLable\r\n\r\nData.Refillable = Backbone.Collection.extend({\r\n\tinitialize: function(options) {\r\n\t\tthis.url = '/back/index.php/units/'+options.id+'/refillable'\r\n\t} \r\n});\r\n\r\nView.RefillableItem = Marionette.View.extend({\r\n\ttemplate: '#RefillableItem',\r\n});\r\nView.RefillableItemEmpty = Marionette.View.extend({\r\n\ttemplate: _.template('EMPTY'),\r\n});\r\nView.RefillableWrapper = Marionette.View.extend({\r\n\ttemplate: '#RefillableWrapper',\r\n\tregions: new RegionSetter('list'),\r\n\tinitialize: function(options) {\r\n\t\t\r\n\t},\r\n\tonRender: function() {\r\n\t\tcollection = new Data.Refillable(this.options);\r\n\t\tcollection.fetch();\r\n\t\tcollection.on('sync', collection => {\r\n\t\t\tthis.getRegion('list').show(new View.Refillable({\r\n\t\t\t\tcollection: collection\r\n\t\t\t}))\r\n\t\t})\r\n\t}\r\n});\r\nView.Refillable = Marionette.CollectionView.extend({\r\n\tchildView: View.RefillableItem,\r\n\temptyView: View.RefillableItemEmpty,\r\n\tinitialize: function(options) {\r\n\t\tthis.collection = options.collection\r\n\t},\r\n});\r\n\r\n\r\n\r\n\r\n// TOOLS\r\n// TOOLS\r\n// TOOLS\r\n// TOOLS\r\n\r\nView.Tools = Marionette.View.extend({\r\n\tclassName: 'list-group',\r\n\ttemplate: '#units-tools',\r\n\tinitialize: function (options) {\r\n\t\tthis.model = options.model;\r\n\t},\r\n\r\n\r\n});\r\n\r\nView.List = Marionette.CollectionView.extend({\r\n\tclassName: 'list-group',\r\n\ttagName: 'ul',\r\n\temptyView: View.ListItemEmpty,\r\n\tchildView: View.ListItem,\r\n\tinitialize: function(options) {\r\n\t\tthis.collection = new Data.List(options);\r\n\t\tthis.collection.fetch();\r\n\t},\r\n\tcollectionEvents: {\r\n\t\t'sync' : 'onSync'\r\n\t},\r\n\tonChildviewOpenMap: function(view) {\r\n\t\tconsole.log(view.model);\r\n\t\tvar model = view.model;\r\n\t\tthis.triggerMethod('show:marker',model);\r\n\t},\r\n\tonSync: function() {\r\n\t\tconsole.log(this.collection.models);\r\n\t\tthis.render();\r\n\t},\r\n\tonRender: function() {\r\n\t}\r\n})\r\n\r\n\r\n\r\n\r\nwindow.module_units = {\r\n\tView: View,\r\n\tData: Data,\r\n\tEntry: View.Entry,\r\n}\r\n}());\r\n"]}